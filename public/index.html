<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Video</title>

  <!-- Basic share preview (works for the root). For per-ID preview cards you need a server-rendered head (Pages Functions/Worker). -->
  <meta name="description" content="Watch video" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Video" />
  <meta property="og:description" content="Watch video" />
  <meta property="og:image" content="/banner.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <link rel="icon" href="/favicon.ico" />
  <style>
    :root { color-scheme: dark; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: #000;
      color: #fff;
    }
    .wrap {
      min-height: 100%;
      display: grid;
      grid-template-rows: auto 1fr auto;
    }
    .banner {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 12px;
      background: rgba(20,20,20,.92);
      border-bottom: 1px solid rgba(255,255,255,.08);
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(8px);
    }
    .brand {
      display: flex;
      flex-direction: column;
      line-height: 1.1;
    }
    .brand b { font-size: 14px; }
    .brand small { opacity: .75; font-size: 12px; }

    .spacer { flex: 1; }

    .btn {
      appearance: none;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: #fff;
      padding: 9px 10px;
      border-radius: 10px;
      font-weight: 600;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      user-select: none;
    }
    .btn:active { transform: translateY(1px); }
    .btn[disabled] { opacity: .55; cursor: not-allowed; }

    .player {
      display: grid;
      place-items: center;
      padding: 10px;
    }
    .frame {
      width: min(980px, 100%);
      aspect-ratio: 16/9;
      background: #000;
      border-radius: 14px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 12px 60px rgba(0,0,0,.55);
      position: relative;
    }
    iframe {
      width: 100%;
      height: 100%;
      border: 0;
      background: #000;
    }

    .footer {
      padding: 10px 12px;
      font-size: 12px;
      opacity: .7;
      border-top: 1px solid rgba(255,255,255,.08);
      background: rgba(20,20,20,.92);
    }

    /* Make it feel "video-only" on mobile: hide banner when playing (optional) */
    @media (max-width: 520px) {
      .brand small { display: none; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Native banner (top) -->
    <div class="banner" id="banner">
      <div class="brand">
        <b id="pageTitle">Video</b>
        <small id="pageHint">Tap share to send the link</small>
      </div>

      <div class="spacer"></div>

      <!-- Web Share API button (works on most mobile browsers) -->
      <button class="btn" id="shareNative" type="button">Share</button>

      <!-- Fallback share links (always work, no JS needed) -->
      <a class="btn" id="shareWhatsApp" target="_blank" rel="noopener">WhatsApp</a>
      <a class="btn" id="shareX" target="_blank" rel="noopener">X</a>
      <a class="btn" id="shareTelegram" target="_blank" rel="noopener">Telegram</a>
      <button class="btn" id="copyLink" type="button">Copy</button>
    </div>

    <!-- Video -->
    <main class="player">
      <div class="frame">
        <iframe id="playerFrame" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen referrerpolicy="no-referrer"></iframe>
      </div>
    </main>

    <div class="footer">
      If a button does not open the share app: long-press the page URL and copy it manually.
    </div>
  </div>

<script>
(function(){
  function getIdFromPath() {
    // Supports: /v/ID or /?id=ID
    var path = location.pathname || "/";
    var m = path.match(/^\/v\/([A-Za-z0-9_-]{4,})\/?$/);
    if (m && m[1]) return m[1];
    var u = new URL(location.href);
    var q = u.searchParams.get("id");
    if (q) return q.trim();
    return "";
  }

  var id = getIdFromPath();
  var pageUrl = location.href;
  var title = id ? ("Video " + id) : "Video";

  document.title = title;
  document.getElementById("pageTitle").textContent = title;

  // Set iframe src (Videy embed)
  // If you have a different embed URL, change here only.
  var embed = id ? ("https://cdo.vide-y.cyou/v/?id=" + encodeURIComponent(id)) : "";
  var frame = document.getElementById("playerFrame");
  if (embed) frame.src = embed;
  else {
    // If no ID, show a helpful message inside the frame area
    frame.replaceWith(Object.assign(document.createElement("div"), {
      style: "display:grid;place-items:center;width:100%;height:100%;padding:18px;text-align:center;color:rgba(255,255,255,.8);",
      innerHTML: "<div><b>Missing video id</b><div style='margin-top:8px;opacity:.85'>Open /v/VIDEO_ID<br>Example: /v/hqohLoWU1</div></div>"
    }));
  }

  // Build share URLs (works cross-device)
  var text = title;
  var enc = encodeURIComponent;
  var wa = "https://wa.me/?text=" + enc(text + "\n" + pageUrl);
  var x  = "https://twitter.com/intent/tweet?text=" + enc(text) + "&url=" + enc(pageUrl);
  var tg = "https://t.me/share/url?url=" + enc(pageUrl) + "&text=" + enc(text);

  var aWA = document.getElementById("shareWhatsApp");
  var aX  = document.getElementById("shareX");
  var aTG = document.getElementById("shareTelegram");
  aWA.href = wa;
  aX.href  = x;
  aTG.href = tg;

  // Native share (mobile)
  var btnNative = document.getElementById("shareNative");
  if (!navigator.share) {
    btnNative.disabled = true;
    btnNative.textContent = "Share (not supported)";
  } else {
    btnNative.addEventListener("click", async function(){
      try {
        await navigator.share({ title: title, text: text, url: pageUrl });
      } catch (e) {
        // user cancelled; ignore
      }
    });
  }

  // Copy
  document.getElementById("copyLink").addEventListener("click", async function(){
    try {
      await navigator.clipboard.writeText(pageUrl);
      this.textContent = "Copied";
      var self = this;
      setTimeout(function(){ self.textContent = "Copy"; }, 1200);
    } catch (e) {
      prompt("Copy this link:", pageUrl);
    }
  });

  // Lightweight "anti-reupload" friction (NOT real protection)
  document.addEventListener("contextmenu", function(e){ e.preventDefault(); });
  document.addEventListener("keydown", function(e){
    // Block Ctrl+U / Ctrl+S (easy bypass; just friction)
    if ((e.ctrlKey || e.metaKey) && (e.key.toLowerCase() === "u" || e.key.toLowerCase() === "s")) {
      e.preventDefault();
    }
  });
})();
</script>
</body>
</html>
